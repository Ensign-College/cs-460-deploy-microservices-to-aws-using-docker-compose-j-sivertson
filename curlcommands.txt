# Security Test - Unauthenticated request (should return 401)
curl -i http://localhost:8080/packages

# List tour packages (authenticated user)
curl -i -u user:password http://localhost:8080/packages

# Create a tour package (admin only)
curl -i -u admin:admin123 -X POST http://localhost:8080/packages \
  -H 'Content-Type: application/json' \
  -d '{"code":"BB","name":"Beekeepers you Betcha"}'

# Delete the tour package (admin only)
curl -i -u admin:admin123 -X DELETE http://localhost:8080/packages/BB

# Tour ratings - GET (authenticated user)
curl -i -u user:password http://localhost:8080/tours/1/ratings

# Tour ratings - POST (admin only)
curl -i -u admin:admin123 -X POST http://localhost:8080/tours/1/ratings \
  -H 'Content-Type: application/json' \
  -d '{"score":5,"comment":"Great tour!","customerId":123}'

# Test user cannot create rating (should return 403)
curl -i -u user:password -X POST http://localhost:8080/tours/1/ratings \
  -H 'Content-Type: application/json' \
  -d '{"score":5,"comment":"Great tour!","customerId":123}'

# Public endpoints (no authentication required)
curl -i http://localhost:8080/actuator/health
curl -i http://localhost:8080/swagger-ui/index.html
